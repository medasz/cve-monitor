package db_exploit

import (
	"fmt"
	"github-cve/db"
	"github-cve/model/exploit"
)

func FirstOrCreate(exp *exploit.Exploit) error {
	fmt.Println(exp)
	return db.DB.FirstOrCreate(exp, exp).Error
}

func GetItemByVulnerabilityId(vulnerabilityId uint) ([]exploit.Exploit, error) {
	tmp := make([]exploit.Exploit, 0)
	err := db.DB.Find(&tmp, "vulnerability_id = ?", vulnerabilityId).Error
	if err != nil {
		return nil, err
	}
	return tmp, nil
}

func DeleteItemsByVulnerabilityId(res []exploit.Exploit) error {
	return db.DB.Delete(res).Error
}
